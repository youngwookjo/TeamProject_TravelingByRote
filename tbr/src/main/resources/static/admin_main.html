<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Admin page</title>
</head>
<body>
<h2>Admin 화면</h2>
<button type="button" onclick="location.href='admin.html'">Logout</button>
<hr>
<img title="Admin 접속후" src="images/person_1.jpg" height="400" width="400">
<hr>
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
    <script src="http://code.jquery.com/jquery-latest.js"></script>
	<script>
		function updateDB() {
			axios.get("http://localhost:8000/dataCollect")
			.then(resData => {
				let phrase = "<p>" + "DB 업데이트 완료, " + resData.data + "</p>"
                $("#table").append(phrase);
			})
		}
		function searchAll() {
			axios.get("http://localhost:8000/getAllUser")
			.then(resData => {
				console.log(resData.data);
				document.all.table.innerHTML = "<h3>전체 회원 리스트</<h3>"
				let table = "<table border=1><tr><td><b>아이디</b></td><td><b>비밀번호</b></td></tr>"
				for(let row of resData.data) {
					console.log(row);
					table += "<tr><td>" + row.id + "</td><td>" + row.pw + "</td></tr>"
				}
				table += "</table>"
				document.all.table.innerHTML += table;
			});			
		}
		function searchAccount(name) {
			axios.get("http://localhost:8000/searchAccount?id="+name)
			.then(resData => {
				console.log(resData.data);
				document.all.table.innerHTML = "<h3>회원 검색</<h3>"
				let table = "<table border=1><tr><td><b>ID</b></td><td><b>비밀번호</b></td></tr>"
				for(let row of resData.data) {
					console.log(row);
					table += "<tr><td>" + row.id + "</td><td>" + row.pw + "</td></tr>"
				}
				table += "</table>"
				document.all.table.innerHTML += table;
			});
		}
		function deleteAccount(name) {
			axios.get("http://localhost:8000/deleteAccount?id="+name)
			.then(resData => {
				console.log(resData.data);
                let phrase = "<p>" + resData.data + "</p>"
                $("#table").append(phrase);
			});			
		}
    </script>
    
    <script>
            function loading() {
                LoadingWithMask('images/Pacman.gif');
                setTimeout("closeLoadingWithMask()", 3000);
            }
             
            function LoadingWithMask(gif) {
                //화면의 높이와 너비를 구합니다.
                var maskHeight = $(document).height();
                var maskWidth  = window.document.body.clientWidth;
                 
                //화면에 출력할 마스크를 설정해줍니다.
                var mask       ="<div id='mask' style='position:absolute; z-index:9000; background-color:#000000; display:none; left:0; top:0;'></div>";
                var loadingImg ='';
                  
                loadingImg +=" <img src='"+ gif +"' style='position: absolute; display: block; margin: 0px auto;'/>";
             
                //화면에 레이어 추가
                $("#table")
                    .append(mask)
             
                //마스크의 높이와 너비를 화면 것으로 만들어 전체 화면을 채웁니다.
                $('#mask').css({
                        'width' : maskWidth,
                        'height': maskHeight,
                        'opacity' :'0.3'
                });
              
                //마스크 표시
                $('#mask').show();
              
                //로딩중 이미지 표시
                $('#loadingImg').append(loadingImg);
                $('#loadingImg').show();
            }
             
            function closeLoadingWithMask() {
                $('#mask, #loadingImg').hide();
                $('#mask, #loadingImg').empty(); 
            }
    </script>        

    <button onclick="updateDB(); loading()">DB 업데이트</button>
    <button onclick="searchAll()">전체 회원 리스트</button>
	<input id="name" type="text">
	<button onclick="searchAccount(document.all.name.value)">회원 검색</button>
	<button onclick="deleteAccount(document.all.name.value)">회원 삭제</button>
<hr>
	<div id="table"></div>
</body>
</html>